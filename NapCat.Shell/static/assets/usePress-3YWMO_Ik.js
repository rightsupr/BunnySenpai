import{aK as re,aL as E,c6 as B,c7 as ae,c8 as ne,aM as g,aN as p,aO as se,c9 as ie,aI as L,ca as oe,aG as le,O as q,cb as fe,aP as ce,_ as G,A as ue,D as pe,aQ as de,X as ve,aR as ge,aF as N}from"./index-CccuTvbI.js";import{b as z}from"./openLink-DRU7_5Wb.js";import{r as k}from"./react-router-dom-BuK5Vxqh.js";function $e(n){let s=k.useContext(fe);if(s){let{register:c,...o}=s;n=q(o,n),c()}return ce(s,n.ref),n}var O=new WeakMap;class D{continuePropagation(){G(this,O,!1)}get shouldStopPropagation(){return ue(this,O)}constructor(s,c,o,u){pe(this,O,{writable:!0,value:void 0}),G(this,O,!0);var $;let P=($=u==null?void 0:u.target)!==null&&$!==void 0?$:o.currentTarget;const v=P==null?void 0:P.getBoundingClientRect();let K,h=0,I,y=null;o.clientX!=null&&o.clientY!=null&&(I=o.clientX,y=o.clientY),v&&(I!=null&&y!=null?(K=I-v.left,h=y-v.top):(K=v.width/2,h=v.height/2)),this.type=s,this.pointerType=c,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=K,this.y=h}}const V=Symbol("linkClicked"),Q="react-aria-pressable-style",W="data-react-aria-pressable";function he(n){let{onPress:s,onPressChange:c,onPressStart:o,onPressEnd:u,onPressUp:$,onClick:P,isDisabled:v,isPressed:K,preventFocusOnPress:h,shouldCancelOnPointerExit:I,allowTextSelectionOnPress:y,ref:_,...Z}=$e(n),[ee,R]=k.useState(!1),m=k.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:M,removeAllGlobalListeners:A}=re(),w=E((e,a)=>{let l=m.current;if(v||l.didFirePressStart)return!1;let t=!0;if(l.isTriggeringEvent=!0,o){let i=new D("pressstart",a,e);o(i),t=i.shouldStopPropagation}return c&&c(!0),l.isTriggeringEvent=!1,l.didFirePressStart=!0,R(!0),t}),x=E((e,a,l=!0)=>{let t=m.current;if(!t.didFirePressStart)return!1;t.didFirePressStart=!1,t.isTriggeringEvent=!0;let i=!0;if(u){let r=new D("pressend",a,e);u(r),i=r.shouldStopPropagation}if(c&&c(!1),R(!1),s&&l&&!v){let r=new D("press",a,e);s(r),i&&(i=r.shouldStopPropagation)}return t.isTriggeringEvent=!1,i}),C=E((e,a)=>{let l=m.current;if(v)return!1;if($){l.isTriggeringEvent=!0;let t=new D("pressup",a,e);return $(t),l.isTriggeringEvent=!1,t.shouldStopPropagation}return!0}),T=E(e=>{let a=m.current;if(a.isPressed&&a.target){a.didFirePressStart&&a.pointerType!=null&&x(S(a.target,e),a.pointerType,!1),a.isPressed=!1,a.isOverTarget=!1,a.activePointerId=null,a.pointerType=null,A(),y||B(a.target);for(let l of a.disposables)l();a.disposables=[]}}),X=E(e=>{I&&T(e)}),U=E(e=>{P==null||P(e)}),Y=E((e,a)=>{if(P){let l=new MouseEvent("click",e);ae(l,a),P(ne(l))}}),te=k.useMemo(()=>{let e=m.current,a={onKeyDown(t){if(F(t.nativeEvent,t.currentTarget)&&g(t.currentTarget,p(t.nativeEvent))){var i;j(p(t.nativeEvent),t.key)&&t.preventDefault();let r=!0;if(!e.isPressed&&!t.repeat){e.target=t.currentTarget,e.isPressed=!0,e.pointerType="keyboard",r=w(t,"keyboard");let f=t.currentTarget,d=b=>{F(b,f)&&!b.repeat&&g(f,p(b))&&e.target&&C(S(e.target,b),"keyboard")};M(L(t.currentTarget),"keyup",ve(d,l),!0)}r&&t.stopPropagation(),t.metaKey&&ge()&&((i=e.metaKeyEvents)===null||i===void 0||i.set(t.key,t.nativeEvent))}else t.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(t){if(!(t&&!g(t.currentTarget,p(t.nativeEvent)))&&t&&t.button===0&&!e.isTriggeringEvent&&!z.isOpening){let i=!0;if(v&&t.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||de(t.nativeEvent))){let r=w(t,"virtual"),f=C(t,"virtual"),d=x(t,"virtual");U(t),i=r&&f&&d}else if(e.isPressed&&e.pointerType!=="keyboard"){let r=e.pointerType||t.nativeEvent.pointerType||"virtual";i=x(S(t.currentTarget,t),r,!0),e.isOverTarget=!1,U(t),T(t)}e.ignoreEmulatedMouseEvents=!1,i&&t.stopPropagation()}}},l=t=>{var i;if(e.isPressed&&e.target&&F(t,e.target)){var r;j(p(t),t.key)&&t.preventDefault();let d=p(t),b=g(e.target,p(t));x(S(e.target,t),"keyboard",b),b&&Y(t,e.target),A(),t.key!=="Enter"&&H(e.target)&&g(e.target,d)&&!t[V]&&(t[V]=!0,z(e.target,t,!1)),e.isPressed=!1,(r=e.metaKeyEvents)===null||r===void 0||r.delete(t.key)}else if(t.key==="Meta"&&(!((i=e.metaKeyEvents)===null||i===void 0)&&i.size)){var f;let d=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let b of d.values())(f=e.target)===null||f===void 0||f.dispatchEvent(new KeyboardEvent("keyup",b))}};if(typeof PointerEvent<"u"){a.onPointerDown=r=>{if(r.button!==0||!g(r.currentTarget,p(r.nativeEvent)))return;if(se(r.nativeEvent)){e.pointerType="virtual";return}e.pointerType=r.pointerType;let f=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=r.pointerId,e.target=r.currentTarget,y||ie(e.target),f=w(r,e.pointerType);let d=p(r.nativeEvent);"releasePointerCapture"in d&&d.releasePointerCapture(r.pointerId),M(L(r.currentTarget),"pointerup",t,!1),M(L(r.currentTarget),"pointercancel",i,!1)}f&&r.stopPropagation()},a.onMouseDown=r=>{if(g(r.currentTarget,p(r.nativeEvent))&&r.button===0){if(h){let f=oe(r.target);f&&e.disposables.push(f)}r.stopPropagation()}},a.onPointerUp=r=>{!g(r.currentTarget,p(r.nativeEvent))||e.pointerType==="virtual"||r.button===0&&C(r,e.pointerType||r.pointerType)},a.onPointerEnter=r=>{r.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,w(S(e.target,r),e.pointerType))},a.onPointerLeave=r=>{r.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,x(S(e.target,r),e.pointerType,!1),X(r))};let t=r=>{if(r.pointerId===e.activePointerId&&e.isPressed&&r.button===0&&e.target){if(g(e.target,p(r))&&e.pointerType!=null){let f=!1,d=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(f?T(r):(le(e.target),e.target.click()))},80);M(r.currentTarget,"click",()=>f=!0,!0),e.disposables.push(()=>clearTimeout(d))}else T(r);e.isOverTarget=!1}},i=r=>{T(r)};a.onDragStart=r=>{g(r.currentTarget,p(r.nativeEvent))&&T(r)}}return a},[M,v,h,A,y,T,X,x,w,C,U,Y]);return k.useEffect(()=>{if(!_)return;const e=L(_.current);if(!e||!e.head||e.getElementById(Q))return;const a=e.createElement("style");a.id=Q,a.textContent=`
@layer {
  [${W}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(a)},[_]),k.useEffect(()=>{let e=m.current;return()=>{var a;y||B((a=e.target)!==null&&a!==void 0?a:void 0);for(let l of e.disposables)l();e.disposables=[]}},[y]),{isPressed:K||ee,pressProps:q(Z,te,{[W]:!0})}}function H(n){return n.tagName==="A"&&n.hasAttribute("href")}function F(n,s){const{key:c,code:o}=n,u=s,$=u.getAttribute("role");return(c==="Enter"||c===" "||c==="Spacebar"||o==="Space")&&!(u instanceof N(u).HTMLInputElement&&!J(u,c)||u instanceof N(u).HTMLTextAreaElement||u.isContentEditable)&&!(($==="link"||!$&&H(u))&&c!=="Enter")}function S(n,s){let c=s.clientX,o=s.clientY;return{currentTarget:n,shiftKey:s.shiftKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,altKey:s.altKey,clientX:c,clientY:o}}function Pe(n){return n instanceof HTMLInputElement?!1:n instanceof HTMLButtonElement?n.type!=="submit"&&n.type!=="reset":!H(n)}function j(n,s){return n instanceof HTMLInputElement?!J(n,s):Pe(n)}const ye=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function J(n,s){return n.type==="checkbox"||n.type==="radio"?s===" ":ye.has(n.type)}export{he as $};
